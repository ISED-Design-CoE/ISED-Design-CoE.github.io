<!DOCTYPE html>
<!--[if lt IE 9]><html class="no-js lt-ie9" lang="en" dir="ltr"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en" dir="ltr"><!--<![endif]-->
	<head>
<!-- Based on CDTS 4.1.0 (https://cenw-wscoe.github.io/sgdc-cdts/docs/index-en.html) with DECoE customizations added (look for "DECoE customization" in comments) -->
	 <meta charset="utf-8">

<!-- Start DECoE customization -->
		<title>
			Technical details - NCLL portal - Spectrum licensing services - Innovation, Science and Economic Development Canada
		</title>
<!-- End DECoE customization -->

		<meta content="width=device-width,initial-scale=1" name="viewport">
		<script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_1_0/cdts/compiled/soyutils.js"></script>
		<script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/v4_1_0/cdts/compiled/wet-en.js"></script>
		<noscript>
			<!-- Write closure fall-back static file -->
			<!-- refTop.html -->
		</noscript>
		<!-- Write closure template -->
		<script>
			document.write(wet.builder.refTop({
				"cdnEnv": "esdcprod"
			}));
		</script>

<!-- Start DECoE customization -->
	<style>
		/* Styles for all mockups */
			.notesaboutmockup {
				color: #333;
				background: #FFD;
				padding: 0 1em;
				border-color: #FC6;
				border-width: 2px;
				border-style: solid;
				margin-top: 3em;
			}
			.notesaboutmockup h2 {
				font-size: inherit;
				margin-top: 1em;
			}
		/* Styles for this mockup */
			.alert-info {
				margin-left: 14px;
			}

			.glyphicon-warning-sign {
				color: #ee7100;
			}
	</style>
	<link href="fix-wet-styles.css" rel="stylesheet" type="text/css">
	<link href="ncl-portal.css" rel="stylesheet" type="text/css">
	<link href="https://sms-sgs.ic.gc.ca/static/css/wizard.css" rel="stylesheet" type="text/css">
<!-- End DECoE customization -->

	</head>
	<body vocab="http://schema.org/" typeof="WebPage">
		<div id="def-top">
			<!-- Write closure fall-back static file -->
			<!-- transactTop-en.html -->
		</div>
		<!-- Write closure template -->
		<script>
			var defTop = document.getElementById("def-top");
			defTop.outerHTML = wet.builder.top({
				"cdnEnv": "esdcprod",
				"lngLinks": [{
					"lang": "fr",
					"href": "transactional-fr.shtml",
					"text": "Français"
				}],
				"search": false,
				"siteMenu": false,
				"breadcrumbs": [{
					"title": "Spectrum Management System",
					"href": "index.html"
				},
				{
					"title": "NCLL portal",
					"href": "portal.html"
				}],
				"showPreContent": false
			});
		</script>
		<main property="mainContentOfPage" typeof="WebPageElement" class="container">

<!-- Start page content -->

	<div id="superhead">
		<p>NCLL application <span class="app-number">01000139-001</span> (28 GHz band) <span class="pull-right" id="status">Draft</span></p>
	</div>
	<div class="form-group">
		<ul class="nav nav-wizard">
			<li><a class="navbar-item" href="general.html">General information</a></li>
			<li><a class="navbar-item" href="contact-mm.html">Contact information</a></li>
			<li class="active" aria-current="step">Technical details</li>
			<li><a class="navbar-item" href="licence-area-mm.html">Licence area</a></li>
			<li><a class="navbar-item" href="review-mm.html">Review application</a></li>
		</ul>
	</div>

	<h1 property="name" id="wb-cont">Technical details</h1>

	<div class="wb-frmvld">
		<form id="technicalDetailForm" action="licence-area-mm.html" method="get">

			<div class="wb-frm">
				<section id="save-div" class="alert alert-success" hidden>
					<p>Application saved as draft</p>
				</section>
				<fieldset class="gc-chckbxrdio">
					<legend class="required">
						<span class="field-name">
							Bandwidth
						</span>
						<strong class="required small" aria-hidden="true">(required)</strong>
					</legend>
					
					<select class="form-control mmwaveBandwidth" id="mmwaveBandwidth" name="bandwidth">
						<option value="50">50 MHz   </option>
						<option value="100">100 MHz </option>
						<option value="150">150 MHz </option>
						<option value="200">200 MHz </option>
						<option value="250">250 MHz </option>
						<option value="300">300 MHz </option>
						<option value="350">350 MHz </option>
						<option value="400">400 MHz </option>
					</select>
				</fieldset>

				<fieldset class="gc-chckbxrdio">
					<legend class="required">
						<span class="field-name">
							Would you like ISED to assign you a frequency block?
						</span>
						<strong class="required small" aria-hidden="true">(required)</strong>
					</legend>
					<details>
						<summary>
							<span class="glyphicon glyphicon-warning-sign"></span>
							Blocks AA1 and AA2 are available on a no-protection, no-interference basis to upper 26&nbsp;GHz flexible use operations.
						</summary>
						<p>The NCL licensees with operations on blocks AA1 and AA2 shall not claim protection from nor cause interference to existing, modified or new flexible use systems in the upper 26 GHz band.</p>
					</details>
					<ul class="list-unstyled lst-spcd-2">
						<li class="radio">
							<input type="radio" id="any" name="any" value="any">
							<label for="any">Yes, please assign me any available frequency block</label>
						</li>
						<li class="radio">
							<input type="radio" id="any-NINP" name="any" value="any-NINP">
							<label for="any-NINP">Yes, but please do not assign me block AA1 or AA2</label>
						</li>
						<li class="radio">
							<input type="radio" id="choose-frequency-block" name="any" value="choose-frequency-block">
							<label for="choose-frequency-block">No, I will choose a frequency block myself</label>
						</li>
					</ul>
				</fieldset>

				<fieldset class="gc-chckbxrdio" id="starting-frequency-input" hidden>
					<legend class="required">
						<span class="field-name">
							Choose your frequency blocks
						</span>
						<strong class="required small" aria-hidden="true">(required)</strong>
					</legend>
				
					<select id='starting-frequency-select' class="form-control " name="bandwidth">
					</select>
				</fieldset>

				

				<fieldset class="gc-chckbxrdio">
					<legend class="required">
						<span class="field-name">
							Will any of your antennas be outdoors?
						</span>
						<strong class="required small" aria-hidden="true">(required)</strong>
					</legend>
					<ul class="list-unstyled lst-spcd-2">
						<li class="radio">
							<input type="radio" id="outdoor" name="antenna" value="Outdoor">
							<label for="outdoor">Yes, at least one antenna will be outdoors</label>
						</li>
						<li class="radio">
							<input type="radio" id="indoor-only" name="antenna" value="Indoor only" data-rule-required="true">
							<label for="indoor-only">No, all antennas will be indoors</label>
							<!-- <div id="high-power-message" class="alert alert-info" hidden>
								<p>High power licences must have at least one outdoor antenna.</p>
							</div> -->
						</li>
					</ul>
				</fieldset>

				<!-- <div class="form-group" id="antenna-height-div" hidden>
					<label for="antenna-height" class="required">
						<span class="field-name">
							Maximum antenna height
						</span>
						<strong class="required">(required)</strong>
					</label>
					<p>Height of highest antenna, above ground, in metres. Cannot exceed building height.</p>
					<input id="antenna-height" name="antenna-height" class="form-control" type="text" size=2 required>
				</div> -->

				<fieldset class="gc-chckbxrdio">
					<legend class="required">
						<span class="field-name">
							Licence type
						</span>
						<strong class="required small" aria-hidden="true">(required)</strong>
					</legend>
					<details>
						<summary>More information<span class="wb-inv"> about licence type</span></summary>
						<ul class="list-unstyled">
							<li>A <strong>low-power</strong> licence can be up to 1 km² in area.</li>
							<li>A <strong>high-power</strong> licence can be between 5 and 50 km² in area.</li>
						</ul>
						<!-- <p>For further information about the consequences of this choice, including maximum permissible e.i.r.p. and maximum antenna height above ground level, see <a href="javascript:alert('Link TBD')">SRSP-521</a>.</p> -->
					</details>
					<ul class="list-unstyled lst-spcd-2">
						<li class="radio">
							<input type="radio" id="low-power" name="power-level" value="Low power" data-rule-required="true">
							<label for="low-power">Low power</label>
						</li>
						<li class="radio">
							<input type="radio" id="high-power" name="power-level" value="High power">
							<label for="high-power">High power</label>
							<div id="indoor-only-message" class="alert alert-info" hidden>
								<p>Indoor-only licences must be low power.</p>
							</div>
					</li>
					</ul>
				</fieldset>
			</div>
		</div>
		<button class="btn btn-primary" type="submit">Next ⯈</button>
		<button class="btn btn-default" type="button" id="save-button">Save</button>
		<br>
		<button class="btn btn-default" type="button" onclick="window.location.href = 'contact-mm.html'+ window.location.search">⯇ Back</button>

		</form>
		<script>
			const saveButton = document.getElementById ( "save-button" )
			const saveDiv = document.getElementById ( "save-div" )
			saveButton .addEventListener ( "click", ( event ) => {
				saveDiv .removeAttribute ( "hidden" )
			})
		</script>
		<script src="catch-and-throw.js"></script>
		<script>
			// Validate the interaction between the Scope of service and Power level fields
			const indoorOnlyField = document.getElementById ( "indoor-only" )
			const outdoorIndoorField = document.getElementById ( "outdoor" )

			const lowPowerField = document.getElementById ( "low-power" )
			const highPowerField = document.getElementById ( "high-power" )
			// const antennaHeightField = document.getElementById ( "antenna-height" )

			const indoorOnlyMessage = document.getElementById ( "indoor-only-message" )
			// const mediumPowerMessage = document.getElementById ( "high-power-message" )
			// const antennaHeightDiv = document.getElementById ( "antenna-height-div" )

			indoorOnlyField .addEventListener ( "click", ( event ) => {
				indoorOnlyMessage .removeAttribute ( "hidden" )
				highPowerField .disabled = true
				// antennaHeightDiv .removeAttribute ( "hidden" )
				// antennaHeightField .setAttribute ( "required" , "required" )
			})

			outdoorIndoorField .addEventListener ( "click", ( event ) => {
				indoorOnlyMessage .setAttribute ( "hidden", "hidden" )
				highPowerField .disabled = false
				// antennaHeightDiv .setAttribute ( "hidden", "hidden" )
				// antennaHeightField .removeAttribute ( "required" )
			})

			// lowPowerField .addEventListener ( "click", ( event ) => {
			// 	mediumPowerMessage .setAttribute ( "hidden", "hidden" )
			// 	indoorOnlyField .disabled = false
			// })

			// highPowerField .addEventListener ( "click", ( event ) => {
			// 	mediumPowerMessage .removeAttribute ( "hidden" )
			// 	indoorOnlyField .disabled = true
			// })

			for ( const [ key, value ] of urlParams ) {
				if (key == 'antenna') {
					if (value == 'Outdoor and indoor') {
						indoorOnlyMessage .setAttribute ( "hidden", "hidden" )
						highPowerField .disabled = false
					}
					if (value == 'Indoor only') {
						indoorOnlyMessage .removeAttribute ( "hidden" )
						highPowerField .disabled = true
					}
				}
				// if (key == 'power-level') {
				// 	if (value == 'Low power') {
				// 		mediumPowerMessage .setAttribute ( "hidden", "hidden" )
				// 		indoorOnlyField .disabled = false
				// 	}
				// 	if (value == 'High power') {
				// 		mediumPowerMessage .removeAttribute ( "hidden" )
				// 		indoorOnlyField .disabled = true
				// 	}
				// }
			}

		// Generate choce for starting frequency
		const frequency_select = document.getElementById('starting-frequency-select');
		const starting_frequency = document.getElementById('mmwaveBandwidth');

		const any_button = document.getElementById('any');
		const any_NINP_button = document.getElementById('any-NINP');
		const choose_button = document.getElementById('choose-frequency-block');
		const starting_frequency_input = document.getElementById('starting-frequency-input')

		//TODO: make this work by reading URL as well.
		any_button.addEventListener ( "click", (event) => {
			starting_frequency_input .setAttribute ( "hidden", null )
		})
		any_NINP_button.addEventListener ( "click", (event) => {
			starting_frequency_input .setAttribute ( "hidden", null )
		})
		choose_button.addEventListener ( "click", (event) => {
			starting_frequency_input .removeAttribute ( "hidden" )
		})

		function generatemmWaveStartingFrequencies() {
			jump = parseInt(starting_frequency.value);
			frequency_select.innerHTML = '';
			for (let i=0;i<(18-(jump/50));i++){
				frequency_end = ((27500+(50*i+(jump)))/1000).toString()
				frequency = ((27500+(50*i))/1000).toString()
				frequency = (frequency =="28") ? frequency.concat('.00') : frequency.padEnd(5,'0')
				frequency_end = (frequency_end =="28") ? frequency_end.concat('.00') : frequency_end.padEnd(5,'0')
				if ( jump == 50 ) { // just one channel
					frequency_select.insertAdjacentHTML('beforeend',
					`<option value="${(jump*i).toString()}">AA${(i+1).toString()} (${frequency} to ${frequency_end} GHz)</option>`);
				} else {
					frequency_select.insertAdjacentHTML('beforeend',
					`<option value="${(jump*i).toString()}">AA${(i+1).toString()} to AA${(i+jump/50).toString()} (${frequency} to ${frequency_end} GHz)</option>`);
				}
			}
		}
		document.getElementById('mmwaveBandwidth').addEventListener('change',generatemmWaveStartingFrequencies);
		generatemmWaveStartingFrequencies();

		</script>
	</div>
	<div id="change-licensee">
		<div class="container">
			<div class="col-md-offset-6 col-md-6">
				<section id="wb-so">
					<h2 class="wb-inv">Sign-on information</h2>
					<button class="btn btn-default" type="button" onclick="window.location = 'select-licensee.html'" >Switch licensee account</button>
					<button class="btn btn-primary" type="button" onclick="window.location = 'login.html'">Sign out</button>
					<p class="small mrgn-tp-sm">User:  <span class="nowrap">John Dutton</span></p>
					<p class="small mrgn-tp-sm">Licensee: <span class="nowrap">The Best Company</span><br>10000005465346</p>
				</section>
				</div>
			</div>
		</div>
	</div>
	<script>
		// Move #change-licensee to top of screen
		// We want it to be immediately under the dark horizontal line, but that line is added by WET so we can't access it until after WET does its thing
		const changeLicensee = document .getElementById ( "change-licensee" )
		const wbBc = document .getElementById ( "wb-bc" )
		wbBc .prepend ( changeLicensee )
	</script>
	<script>
		// Read application number from parameters if present
		if ( urlParams .has ( "app-number" ) ) {
			const appNumberText = urlParams .get ( "app-number" )
			for ( let elem of document .getElementsByClassName ( "app-number" ) ) {
				elem .innerText = appNumberText
			}
		}
	</script>
<!-- End page content -->

			<div id="def-preFooter">
				<!-- Write closure fall-back static file -->
				<!-- preFooter-en.html -->
			</div>
			<!-- Write closure template -->
			<script>
				var defPreFooter = document.getElementById("def-preFooter");
				defPreFooter.outerHTML = wet.builder.preFooter({
					"cdnEnv": "esdcprod",
					"versionIdentifier": "CD56",
					"showPostContent": false,
					"showFeedback": false,
					"showShare": false
				});
			</script>
		</main>
		<div id="def-footer">
			<!-- Write closure fall-back static file -->
			<!-- transactFooter-en.html -->
		</div>
		<!-- Write closure template -->
		<script>
			var defFooter = document.getElementById("def-footer");
			defFooter.outerHTML = wet.builder.footer({
				"cdnEnv": "esdcprod",
				"showFooter": false,
				"showFeatures": false,
				"termsLink": [{
        			"newWindow": true
				}],
				"privacyLink": [{
					"newWindow": true
				}],
				"contextualFooter":{
					"title": "Spectrum and Telecommunications Sector",
					"links": [{
						"text": "Contact us",
						"href":"https://ised-isde.canada.ca/site/spectrum-management-telecommunications/en/licences-and-certificates/radiocom-information-circulars-ric/ric-66-addresses-and-telephone-numbers-district-offices",
						"newWindow": true
					}]
				}
			});
		</script>
		<!-- Write closure template -->
		<script>
			document.write(wet.builder.refFooter({
				"cdnEnv": "esdcprod"
			}));
		</script>
		<script src="queries-in-navbar.js"></script>
	</body>
</html>
